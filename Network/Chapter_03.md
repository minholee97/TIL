### 1. 케이블과 리피터, 허브 속을 신호가 흘러간다
#### 1. 하나하나의 패킷이 독립된 것으로 동작
- 컴퓨터에서 송신된 패킷은 허브나 라우터라는 중계 장치에 의해 중계되어 목적지를 향해 진행함
- 애플리케이션의 데이터나 TCP 프로토콜의 제어 정보의 내용은 패킷을 운반하는 동작에 영향을 주지않으므로 HTTP 메시지, TCP의 수신 확인, 시퀀스 번호 등 모든게 무시.
#### 2. LAN 케이블은 신호를 약화시키지 않는 것이 핵심
- LAN 어댑터의 PHY(MAU) 회로에서 전기 신호로 바꾼 패킷은 RJ-45 커넥터를 통해 트위스트 페어 케이블에 들어 감
- 이더넷의 신호는 플러스와 마이너스 전압임, LAN 어댑터의 PHY(MAU) 회로의 플러스와 마이너스 신호 단자에서 신호가 나옴
- 케이블을 통과하는 동안 에너지가 조금씩 떨어지므로 케이블의 길이가 길수록 신호가 약해짐
- 송신측에서 각진 신호를 보내도 신호의 각진 부분은 전압이 급격하게 높으므로 주파수가 높다는 의미인데 주파수가 높으면 전파 방출량이 높아 전파로 방출된 만큼 에너지가 손실되어 각이 뭉개짐
- 여기에 잡음까지 더해지면 신호가 변형되어 0과 1을 잘못 판독할 수 있음
#### 3. '꼼'은 잡음을 방지하기 위한 방법
- LAN 케이블로 사용하는 트위스트 페어 케이블은 신호선을 마주 꼬아서 잡음을 어느정도 막을 수 있음
- 잡음의 원인은 케이블 주위에서 발생하는 전자파인데 전자파가 금속같은 도전체에 닿으면 그안에 전류가 발생하는 성질이 있음
- 이 때문에 케이블의 주위에 전자파가 있으면 신호와는 다른 전류가 케이블 안에 흐름
- 신호도 전압에 의해 생기는 전류인데 이게 섞이면 신호의 파형이 변형되버려서 이걸 잡음이라고 함
- 케이블에 영향을 받는 전자파는 두 종류가 있는데 그 중 하나는 모니터, 형광등, CRT 모니터와 같은 기기에서 누설되는 전자파임
- 이것들은 케이블 밖에서 오는 것이므로 선을 꼬아서 막을 수 있음
- 신호선은 금속으로 만들어져서 거기에 전자파가 닿으면 전자파의 진행 방향의 오른쪽으로 도는 전류가 생기는 성질이 있음
- 선을 마주 꼬면 나선형이 되어 꼰 옆의 선에서 전류가 흐르는 방향이 반대가 됨
- 따라서 꼬았을때 맞닿는 부분에서 서로 상쇄되어 잡음 전류가 약해짐
- 또 하나는 같은 케이블 안의 인접한 신호선에서 누설되는 전자파임
- 신호선 안에는 신호라는 전류가 흐르므로 전류에 의해 주위에 전자파가 생기는데 이것이 다른 신호선에 대한 잡음이 됨, 이거를 크로스토크 라고함
- 이것을 막는 것도 신호선을 마주 꼬는 것임, 한 개의 케이블에 넣은 신호선을 꼬는 간격을 조금씩 다르게해서 어떤 부분에서는 플러스 신호가 가깝고 어떤 부분에서는 마이너스 신호가 가까워서 잡음의 영향이 반대가 되므로 줄어듬
- 이 방법외에도 신호선 사이에 격리판을 넣거나 금속성 차폐 피복을 입히는 등의 대책이 있음
#### 4. 리피터 허브는 연결되어 있는 전체 케이블에 신호를 송신함
- 신호가 리피터 허브에 도달하면 LAN 전체에 신호가 흩어지고 MAC 주소가 일치하는 기기만 패킷을 수신함
- 리피터 허브 내부는 LAN 어댑터와 유사하게 RJ-45 커넥터에서 받아서 PHY(MAU) 회로랑 연결되는데 송신단자에서 보낸 신호를 수신단자로 받기 위해 선이 크로스 되어있음
- PHY(MAU)에 도달한 신호는 리피터 회로에 들어가고 리피터 회로는 리피터 허브의 커넥터 부분에 신호를 뿌림
### 2. 스위칭 허브의 패킷 중계 동작
#### 1. 스위칭 허브는 주소 테이블로 중계
- 신호가 커넥터에 도달하고 PHY(MAU) 회로에서 수신한 뒤 신호 형식을 공통 형식으로 변환 후 MAC 회로에 들어감
- 여기서 디지털 데이터로 변환하고 FCS를 대조해서 오류 유무를 검사하고 이상이 없으면 버퍼 메모리에 저장 (LAN 어댑터와 유사한데 같은 회로가 안에 있다고 생각)
- PC에 다수의 LAN 어댑터를 장착하고 모든 패킷을 수신하는 동작을 수행하도록 설정하면 스위칭 허브와 유사
- LAN 어댑터와 달리 MAC 회로에는 MAC 주소가 할당되어 있지 않음
- 패킷을 버퍼 메모리에 저장하면 다음 수신처 MAC 주소와 일치하는 것이 MAC 주소표에 등록되어 있는지 조사
- 주소표에는 MAC 주소랑 그 기기가 어느 포트랑 연결되어 있는지 정보가 있어서 이 패킷을 어느 포트로 내보낼지 결정 가능함
- 포트를 정했다면 스위치 회로를 경유해서 패킷을 송신측 포트로 보냄
- 스위치 회로를 경유해서 송신측의 포트에 패킷을 운반하면 MAC회로나 PHY(MAU)회로가 송신을 수행해서 케이블에 신호가 흐름
- 반이중 통신의 경우 케이블에 흘리는 과정이 LAN 어댑터와 동일함
#### 2. MAC 주소 테이블을 등록 및 갱신
- 스위칭 허브는 패킷을 중계할 때 MAC 주소표의 내용을 갱신하는 동작도 실행
- 패킷 수신시 송신처 MAC 주소와 입력 포트를 세트로 주소표에 등록
- 또한 일정 시간이 경과하면 오래된 MAC 주소표의 내용을 삭제
#### 3. 예외적인 동작
- 스위칭 허브에 리피터 허브가 접속되어 있는 경우 리피터 허브에 패킷을 보내면 목적지와 스위치 둘 다 송신하게 되고 스위치에서는 목적지가 있는 리피터로 다시 보내기 때문에 목적지에서는 두 개의 패킷을 받게 되므로 스위치는 패킷을 수신한 포트와 송신하는 포트가 같으면 폐끼함
- MAC 주소표에 일치하는 MAC 주소가 없는 경우 수신한 포트를 제외한 모든 포트에 패킷을 송신함.
#### 4. 전이중 모드에서 송, 수신을 동시 싷행
- 스위칭 허브는 송, 수신을 동시에 하는 전이중 모드가 가능함 (리피터는 불가)
- 트위스트 페어 케이블의 신호선은 송, 수신이 나뉘어져 있고, 스위치 허브의 포트나 LAN 어댑터에도 PHY(MAU) 회로와 MAC 회로 내부도 송, 수신이 나뉘어 있어서 충돌하지 않음
- 스위칭 허브는 전이중 모드를 사용하여 송신과 수신을 동시에 실행
#### 5. 최적의 전송 속도로 보내는 자동 조정
- 접속한 상대가 전이중 모드를 지원하는지와 전송 속도를 검출하고 동작 모드를 전환함
- 이더넷은 데이터가 흐르고 있지 않을때 링크 펄스라는 신호를 흘려서 상대가 올바르게 작동하는지 케이블이 단선되지 않았는지 확인함
- 이 링크 펄스 신호에 자신의 전송 속도와 지원 가능 모드를 통지하고 최적의 조합을 자신에게 설정함
#### 6. 스위칭 허브는 복수의 중계 동작을 동시 실행
- 리피터는 들어온 신호를 모든 포트에서 뿌리므로 동시에 뿌리면 충돌할 수 있으나 리피터는 수신처 MAC 주소의 포트만 송신하므로 다른 포트에 별도의 패킷을 뿌릴 수 있음 
